<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="建立了新的部落格在 github.io 上面，想說順手把自動建置跟發佈一起做一做，但就遇到了一堆問題，原本以為 1~2 小時可以全部設定完，但整個週日就這樣不見了，主要還是沒用過 Travis-ci…GithubGithub Pages我記得幾年前的 Github Pages 是在 repo 裡開一條 github-page branch ，然後在這條 branch 上的東西可以透過 github"><meta name="keywords" content="Hexo,blog,travis-ci"><meta property="og:type" content="article"><meta property="og:title" content="Hexo 整合 Travis-ci 自動建置與發佈"><meta property="og:url" content="https:&#x2F;&#x2F;ghosttw.github.io&#x2F;2019&#x2F;12&#x2F;01&#x2F;init-blog-hexo-travisci&#x2F;index.html"><meta property="og:site_name" content="Ghost Notes"><meta property="og:description" content="建立了新的部落格在 github.io 上面，想說順手把自動建置跟發佈一起做一做，但就遇到了一堆問題，原本以為 1~2 小時可以全部設定完，但整個週日就這樣不見了，主要還是沒用過 Travis-ci…GithubGithub Pages我記得幾年前的 Github Pages 是在 repo 裡開一條 github-page branch ，然後在這條 branch 上的東西可以透過 github"><meta property="og:locale" content="en"><meta property="og:image" content="https:&#x2F;&#x2F;ghosttw.github.io&#x2F;2019&#x2F;12&#x2F;01&#x2F;init-blog-hexo-travisci&#x2F;deploy-hexo-github-travis.svg"><meta property="og:image" content="https:&#x2F;&#x2F;ghosttw.github.io&#x2F;2019&#x2F;12&#x2F;01&#x2F;init-blog-hexo-travisci&#x2F;github-personal-token-authorization.png"><meta property="og:updated_time" content="2020-03-16T00:47:39.339Z"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https:&#x2F;&#x2F;ghosttw.github.io&#x2F;2019&#x2F;12&#x2F;01&#x2F;init-blog-hexo-travisci&#x2F;deploy-hexo-github-travis.svg"><link rel="shortcut icon" href="https://www.gravatar.com/avatar/c8f176b79aa08810588a44a4a23d7ec8?s=16"><link rel="icon" type="image/png" href="https://www.gravatar.com/avatar/c8f176b79aa08810588a44a4a23d7ec8?s=192" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="https://www.gravatar.com/avatar/c8f176b79aa08810588a44a4a23d7ec8?s=180"><title>Hexo 整合 Travis-ci 自動建置與發佈</title><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/rtl.css"><link rel="alternate" href="/atom.xml" title="Ghost Notes" type="application/atom+xml"><link rel="stylesheet" href="/css/prism-material-dark.css" type="text/css"></head><body class="max-width mx-auto px3 ltr"><div id="header-post"><a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")' style="display:none"><i class="fas fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archives/">Writing</a></li><li><a href="/tags/">tags</a></li><li><a href="/categories/">categories</a></li><li><a href="/search/">Search</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="/2019/12/02/net-core-3-new-worker-service/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fas fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id="i-prev" class="info" style="display:none">Previous post</span> <span id="i-next" class="info" style="display:none">Next post</span> <span id="i-top" class="info" style="display:none">Back to top</span> <span id="i-share" class="info" style="display:none">Share post</span></span><br><div id="share" style="display:none"><ul><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/" target="_blank" rel="noopener"><i class="fab fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&text=Hexo 整合 Travis-ci 自動建置與發佈" target="_blank" rel="noopener"><i class="fab fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&title=Hexo 整合 Travis-ci 自動建置與發佈" target="_blank" rel="noopener"><i class="fab fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&is_video=false&description=Hexo 整合 Travis-ci 自動建置與發佈" target="_blank" rel="noopener"><i class="fab fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Hexo 整合 Travis-ci 自動建置與發佈&body=Check out this article: https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/"><i class="fas fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&title=Hexo 整合 Travis-ci 自動建置與發佈" target="_blank" rel="noopener"><i class="fab fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&title=Hexo 整合 Travis-ci 自動建置與發佈" target="_blank" rel="noopener"><i class="fab fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&title=Hexo 整合 Travis-ci 自動建置與發佈" target="_blank" rel="noopener"><i class="fab fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&title=Hexo 整合 Travis-ci 自動建置與發佈" target="_blank" rel="noopener"><i class="fab fa-digg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.tumblr.com/share/link?url=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&name=Hexo 整合 Travis-ci 自動建置與發佈&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr" aria-hidden="true"></i></a></li><li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&t=Hexo 整合 Travis-ci 自動建置與發佈" target="_blank" rel="noopener"><i class="fab fa-hacker-news" aria-hidden="true"></i></a></li></ul></div><div id="toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Github"><span class="toc-number">1.</span> <span class="toc-text">Github</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Github-Pages"><span class="toc-number">1.1.</span> <span class="toc-text">Github Pages</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Integrate-with-Travis-ci"><span class="toc-number">1.2.</span> <span class="toc-text">Integrate with Travis-ci</span></a></li></ol></li></ol></div></span></div><div class="content index py4"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Hexo 整合 Travis-ci 自動建置與發佈</h1><div class="meta"><span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Ghost Notes</span></span><div class="postdate"><time datetime="2019-12-01T14:37:56.000Z" itemprop="datePublished">2019-12-01</time></div><div class="article-tag"><i class="fas fa-tag"></i> <a class="tag-link" href="/tags/Hexo/" rel="tag">Hexo</a>, <a class="tag-link" href="/tags/blog/" rel="tag">blog</a>, <a class="tag-link" href="/tags/travis-ci/" rel="tag">travis-ci</a></div></div></header><div class="content" itemprop="articleBody"><p>建立了新的部落格在 github.io 上面，想說順手把自動建置跟發佈一起做一做，但就遇到了一堆問題，原本以為 1~2 小時可以全部設定完，但整個週日就這樣不見了，主要還是沒用過 Travis-ci…</p><h2 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h2><h3 id="Github-Pages"><a href="#Github-Pages" class="headerlink" title="Github Pages"></a>Github Pages</h3><p>我記得幾年前的 Github Pages 是在 repo 裡開一條 github-page branch ，然後在這條 branch 上的東西可以透過 github.io 讀到，但今天在建立時發現一定要發到 master branch 上，導致有許多網路上的教學一不敷使用。</p><h3 id="Integrate-with-Travis-ci"><a href="#Integrate-with-Travis-ci" class="headerlink" title="Integrate with Travis-ci"></a>Integrate with Travis-ci</h3><p>這是整個 Travis-ci 與 blog 流程</p><img src="/2019/12/01/init-blog-hexo-travisci/deploy-hexo-github-travis.svg" title="deploy-hexo-github-travis"><ol><li><p>安裝 TravisCI app 在 github repo 上</p><p>這部分沒有紀錄到，請自行參考網路上的方式。<br><a href="https://github.com/apps/travis-ci" target="_blank" rel="noopener">install travis-ci app</a></p></li><li><p>我們先將建立好的 Hexo repo 搬到新建立的 branch hexo 上，推上去後再回去把 master branch 清光光。</p></li></ol><pre class="language-powershell"><code class="language-powershell">git checkout <span class="token operator">-</span>b hexo
git add <span class="token punctuation">.</span>
git commit <span class="token operator">-</span>m <span class="token string">"move to hexo"</span>
git push
git checkout master
<span class="token function">rm</span> C:\Users\ghost\Projects\Github\blog\ <span class="token operator">-</span>Recurse <span class="token operator">-</span>Force
git add <span class="token punctuation">.</span>
git commit <span class="token operator">-</span>m <span class="token string">"clean master"</span>
git push
git checkout hexo</code></pre><ol start="3"><li>在 repo 下建立一個 <code>.travis.yml</code> 給 travis-ci 使用，請自行換掉設定</li></ol><pre class="language-yml"><code class="language-yml">sudo: required
language: node_js
node_js: stable
cache: npm
branches:
  only:
  - hexo
before_install:
- npm install -g hexo-cli
install:
- npm install
script:
- hexo clean
- git config --global user.name "Ghost Yang"
- git config --global user.email "ghosttw88@hotmail.com"
- sed -i'' "s~git@github.com:GhostTW/ghosttw.github.io.git~https://${REPO_TOKEN}@github.com/GhostTW/ghosttw.github.io.git~" _config.yml
- hexo deploy</code></pre><ol start="4"><li>在 github 取得 Personal Access token</li></ol><p>GitHub &gt; Settings &gt; Developer settings &gt; Personal access tokens &gt; Generate new token</p><img src="/2019/12/01/init-blog-hexo-travisci/github-personal-token-authorization.png" title="github-personal-token-authorization"><ol start="5"><li>把這組 token 處理過後加入設定檔<ol><li>確認有安裝過 ruby</li><li>cmd 在 repo 下，執行以下指令，記得換掉 {personal_access_token}</li></ol></li></ol><pre class="language-bat"><code class="language-bat">gem isntall travis
travis login --pro --github-token {personal_access_token}
travis encrypt --com 'REPO_TOKEN={personal_access_token}' --add</code></pre><p>它會自動在 <code>.travis.yml</code> 加入設定，讓 travis 在 build 時可以拿這個 token 換掉一開始在 <code>.travis.yml</code> 裡的 <code>${REPO_TOKEN}</code> 字串</p><ol start="6"><li>_config.yml</li></ol><p>最後一步在 <code>_config.yml</code> 設定 hexo deploy 方式</p><pre class="language-yml"><code class="language-yml">deploy:
  type: git
  repo: git@github.com:GhostTW/ghosttw.github.io.git
  branch: master</code></pre><ol start="7"><li>Final</li></ol><p>最後將你的 blog 推到 hexo 後就會自動建置嚕!</p></div></article><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul><li><a href="/">Home</a></li><li><a href="/archives/">Writing</a></li><li><a href="/tags/">tags</a></li><li><a href="/categories/">categories</a></li><li><a href="/search/">Search</a></li></ul></div><div id="toc-footer" style="display:none"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Github"><span class="toc-number">1.</span> <span class="toc-text">Github</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Github-Pages"><span class="toc-number">1.1.</span> <span class="toc-text">Github Pages</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Integrate-with-Travis-ci"><span class="toc-number">1.2.</span> <span class="toc-text">Integrate with Travis-ci</span></a></li></ol></li></ol></div><div id="share-footer" style="display:none"><ul><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/" target="_blank" rel="noopener"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&text=Hexo 整合 Travis-ci 自動建置與發佈" target="_blank" rel="noopener"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&title=Hexo 整合 Travis-ci 自動建置與發佈" target="_blank" rel="noopener"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&is_video=false&description=Hexo 整合 Travis-ci 自動建置與發佈" target="_blank" rel="noopener"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Hexo 整合 Travis-ci 自動建置與發佈&body=Check out this article: https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&title=Hexo 整合 Travis-ci 自動建置與發佈" target="_blank" rel="noopener"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&title=Hexo 整合 Travis-ci 自動建置與發佈" target="_blank" rel="noopener"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&title=Hexo 整合 Travis-ci 自動建置與發佈" target="_blank" rel="noopener"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&title=Hexo 整合 Travis-ci 自動建置與發佈" target="_blank" rel="noopener"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.tumblr.com/share/link?url=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&name=Hexo 整合 Travis-ci 自動建置與發佈&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://ghosttw.github.io/2019/12/01/init-blog-hexo-travisci/&t=Hexo 整合 Travis-ci 自動建置與發佈" target="_blank" rel="noopener"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li></ul></div><div id="actions-footer"><a id="menu" class="icon" href="#" onclick='return $("#nav-footer").toggle(),!1'><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a> <a id="toc" class="icon" href="#" onclick='return $("#toc-footer").toggle(),!1'><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a> <a id="share" class="icon" href="#" onclick='return $("#share-footer").toggle(),!1'><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a> <a id="top" style="display:none" class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></div></div></div><footer id="footer"><div class="footer-left">Copyright &copy; 2020 Ghost Yang</div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archives/">Writing</a></li><li><a href="/tags/">tags</a></li><li><a href="/categories/">categories</a></li><li><a href="/search/">Search</a></li></ul></nav></div></footer></div><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css"><script src="/lib/jquery/jquery.min.js"></script><script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">$(function(){$(".highlight .code pre").before('<span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span>'),new ClipboardJS(".btn-copy",{target:function(e){return e.nextElementSibling}}).on("success",function(e){e.trigger.setAttribute("aria-label","Copied!"),e.clearSelection()})})</script><script src="/js/main.js"></script><script type="text/javascript">!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="//www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script"),ga("create","UA-153636272-1","auto"),ga("send","pageview")</script></body></html>